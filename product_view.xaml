!!!xml1.0

~openerp
    ~data

        // Add external_id, label tab, and cost tab to product.product

        ~record #product_normal_form_view_xml_id model='ir.ui.view'
            @name: view.product.product.form.xml_id
            @model: product.product
            @inherit_id ref='stock.view_normal_procurement_locations_form'
            @priority eval='7'
            @arch type='xml'
                ~page $Information position='after'
                    ~page $Shipping_Instructions
                        @spcl_ship_instr nolabel='1' placeholder='Special shipping instructions here...'
                ~page $Sales position='after'
                    ~page $Labels
                        @label_text nolabel='0'
                        @label_server_stub nolabel='1'
                    // ~page $Costs groups='fis_integration.purchase_cost'
                    //   @cost_server_stub
                @loc_rack position='replace'
                @loc_row position='replace'
                @loc_case position='replace'
                    @fis_location
                @list_price position='after'
                    @shipped_as
                @default_code position='replace'
                    @xml_id
                    @trademark invisible='1'
                    @trademark_state attrs="{'invisible': [('trademark','=',False)]}"
                    @trademark_expiry_year attrs="{'invisible': [('trademark','=',False)]}"
                    @trademark_renewal_date attrs="{'invisible': [('trademark','=',False)]}"
                ~xpath expr="//group[@string='Stock and Expected Variations']/label" position='replace'
                ~xpath expr="//group[@string='Stock and Expected Variations']/div/field" position='replace'
                ~xpath expr="//group[@string='Stock and Expected Variations']/div" position='replace'
                ~xpath expr="//field[@name='virtual_available']" position='replace'
                ~xpath expr="//field[@name='incoming_qty']" position='replace'
                ~xpath expr="//field[@name='outgoing_qty']" position='replace'
                ~xpath expr="//group[@string='Stock and Expected Variations']" position='replace'
                    ~separator $Stock_and_Expected_Variations .oe_text_center colspan=4
                    ~group attrs="{'invisible': [('type', '=', 'service')]}" groups='base.group_user'
                        @virtual_available attrs="{'readonly': [('xml_id','!=',False)]}"
                        @st_makeable_qty readonly=True
                    ~group attrs="{'invisible': [('type', '=', 'service')]}" groups="base.group_user"
                        @qty_available attrs="{'readonly': [('xml_id','!=',False)]}"
                        @incoming_qty attrs="{'readonly': [('xml_id','!=',False)]}"
                        @outgoing_qty attrs="{'readonly': [('xml_id','!=',False)]}"

        ~record #product_product_tree_view_xml_id model='ir.ui.view'
            @name: fis_integration.product.tree
            @model: product.product
            @inherit_id ref='product.product_product_tree_view'
            @arch type='xml'
                @default_code position='replace'
                    @xml_id

        ~record #product_normal_action model='ir.actions.act_window'
            @name: Products
            @type: ir.actions.act_window
            @res_model: product.product
            @domain: ['|',('product_tmpl_id.product_manager','=',uid),('product_tmpl_id.product_manager','=',False)]

        ~record #product_normal_action_sell model='ir.actions.act_window'
            @name: Products
            @type: ir.actions.act_window
            @res_model: product.product
            @domain: ['|',('product_tmpl_id.product_manager','=',uid),('product_tmpl_id.product_manager','=',False)]

        ~record #product_search_form_view_fis model='ir.ui.view'
            @name: product.search.fis.form
            @model: product.product
            @inherit_id ref='product.product_search_form_view'
            @arch type='xml'
                @name position='replace'
                    @name $Product filter_domain="['|',('name','ilike',self),('default_code','ilike',self),('xml_id','!=',False)]"
                ~filter @filter_to_sell position='before'
                    ~filter @fis_avail $Available domain="[('avail', '=', 'Available'),('xml_id','!=',False)]"

        ~record #product_normal_action model='ir.actions.act_window'
            @name: Products
            @type: ir.actions.act_window
            @res_model: product.product
            @view_type: form
            @view_mode: tree,form,kanban
            @view_id ref='product.product_product_tree_view'
            @search_view_id ref='fis_integration.product_search_form_view_fis'
            @domain: [('xml_id','!=',False)]
            @help type='html'
              ~p class='oe_view_nocontent_create'
                Click to define a new product.
              ~p
                You must define a product for everything you buy or sell,
                whether it's a physical product, a consumable or service.

        ~record #product_category_list_view_xml_id model='ir.ui.view'
            @name: product.category.list.xml_id
            @model: product.category
            @inherit_id ref='product.product_category_list_view'
            @arch type='xml'
                @complete_name position='after'
                    @xml_id

        ~record #product_category_form_view_xml_id model='ir.ui.view'
            @name: product.category.form.xml_id
            @model: product.category
            @inherit_id ref='product.product_category_form_view'
            @arch type='xml'
                @parent_id position='before'
                    ~group colspan='4'
                        ~field name='xml_id'

        // add trademark

        ~record #product_trademark_list_view model='ir.ui.view'
            @name: Product Trademark
            @model: product.product
            @arch type='xml'
                ~tree $Trademark_Products colors="red:trademark_state == 'dead';orange:trademark_state == 'dying' or trademark_state == 'renewing';green:trademark_state == 'healthy'"
                    @xml_id
                    @name
                    @trademark_state invisible='1'
                    @trademark_expiry_year
                    @trademark_renewal_date

        ~record #product_trademark_search model='ir.ui.view'
            @name: Product Trademark Search
            @model: product.product
            @arch type='xml'
                ~search $Search_Trademark
                    ~filter $All_Trademarked @type_trademark_all domain="[('trademark_expiry_year','!=',False)]"
                    ~separator
                    ~filter $Active_Trademarked @type_trademark_active domain="[('trademark_state','!=','dead')]"
                    ~filter $Expiring_Trademarked @type_trademark_expiring domain="[('trademark_state','in',['dying','renewing'])]"
                    ~filter $Inactive_Trademarked @type_trademark_inactive domain="[('trademark_state','=','dead')]"

        ~record #product_trademark_action model='ir.actions.act_window'
            @name: Product Trademark
            @type: ir.actions.act_window
            @res_model: product.product
            @view_type: form
            @view_mode: tree,form,kanban
            @view_id ref='fis_integration.product_trademark_list_view'
            @search_view_id ref='product_trademark_search'
            @context eval="{'search_default_type_trademark_all':1}"

        ~menuitem @Trademarks #product_trademarked parent='base.menu_product' action='product_trademark_action' groups='base.group_sale_salesman'

        // Add product available at entries

        ~record model='ir.ui.view' #product_available_at_form
            @name: Product Locations
            @model: product.available_at
            @type: form
            @arch type='xml'
                ~form $Locations
                    @xml_id attrs="{'readonly':True}"
                    @name colspan='4'
                    ~notebook colspan='4'
                        ~page $Products_at_this_location
                            @product_ids nolabel='1'
                                ~tree
                                    @name
                        ~page $Notes

        ~record model='ir.ui.view' #product_available_at_tree
            @name: Product Locations
            @model: product.available_at
            @type: tree
            @arch type='xml'
                ~tree $Locations
                    @name
                    @xml_id attrs="{'readonly':True}"

        ~record model='ir.actions.act_window' #product_available_at_action
            @name: Product Locations
            @res_model: product.available_at
            @view_type: form
            @view_id ref='product_available_at_tree'
            @view_mode: tree,form

        ~menuitem @Locations #product.available_at parent='product.prod_config_main' action='product_available_at_action' groups='base.group_user'

        ~record model='ir.ui.view' #production_line_tree
            @name: Production Lines
            @model: fis_integration.production_line
            @type: tree
            @arch type='xml'
                ~tree $Production_Lines create='false'
                    @name

        ~record model='ir.actions.act_window' #production_line_tree_action
            @name: Production Lines
            @res_model: fis_integration.production_line
            @view_type: tree
            @view_id ref='production_line_tree'
            @view_mode: tree

    ~data noupdate='1'

        ~record model='ir.cron' #product_location_update
            @name: Product Locations Update
            @interval_number: 1
            @interval_type: days
            @numbercall: -1
            @doall eval='False'
            @model eval="'product.available_at'"
            @function eval="'fis_updates'"
            @args eval="'()'"
            @nextcall eval="'2013-04-09 20:00:00'"
            @priority: 100

        ~record model="ir.cron" #product_category_update
            @name: Product Categories Update
            @interval_number: 1
            @interval_type: days
            @numbercall: -1
            @doall eval="False"
            @model eval="'product.category'"
            @function eval="'fis_updates'"
            @args eval="'()'"
            @nextcall eval="'2013-04-09 20:15:00'"
            @priority: 100

        ~record model='ir.cron' #product_inventory_update
            @name: Product Inventory Update
            @interval_number: 1
            @interval_type: days
            @numbercall: -1
            @doall eval="False"
            @model eval="'product.product'"
            @function eval="'fis_updates'"
            @args eval="'()'"
            @nextcall eval="'2013-04-09 21:00:00'"
            @priority: 200

        ~record model='ir.cron' #production_line_update
            @name: Production Line Update
            @interval_number: 1
            @interval_type: days
            @numbercall: -1
            @doall eval="False"
            @model eval="'fis_integration.production_line'"
            @function eval="'fis_updates'"
            @args eval="'()'"
            @nextcall eval="'2014-03-14 20:30:00'"
            @priority: 100

        ~record model='ir.cron' #production_trademark_days_remaining_update
            @name: Trademark Days Remaining Update
            @interval_number: 1
            @interval_type: days
            @numbercall: -1
            @doall eval="False"
            @model eval="'product.product'"
            @function eval="'update_time_remaining'"
            @args eval="'()'"
            @nextcall eval="'2016-11-18 23:00:00'"
            @priority: 100
